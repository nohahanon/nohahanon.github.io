<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="sf novel recommendation">
    <meta name="format-detection" content="telephone=no,address=no,email=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="noindex,nofollow">
    <title>情報処理安全確保支援士の勉強メモ</title>
    <link rel="shortcut icon" href="figs/falling.png" >
    <link rel="stylesheet" href="leaf.css">
  </head>
  <body>
    <h1>情報処理安全確保支援士の勉強メモ</h1>
    忘れがちな内容についてのメモです。
    
    <h2>OSI参照モデル</h2>
    <ol>
      <li>アプリケーション層: ゲートウェイでアプリケーション間を接続し、色々なユーザデータを受け渡す。(HTTP, SMTP, POP, S/MIME, FTP, DNS, LDAP, SSH, DHCP, etc.)</li>
      <li>プレゼンテーション層: ゲートウェイで表示形式間を接続し、色々なユーザデータを受け渡す。 HTMLはここで使われる技術。(Telnet, etc.)</li>
      <li>セッション層: ゲートウェイでセッション間を接続し、色々なユーザデータを受け渡す。HTTPSはここの技術に世話になる。 (TSL, etc.)</li>
      <li>トランスポート層: ゲートウェイでポート間を接続し、色々なユーザデータを受け渡す。 (TCP, UDP, etc.)</li>
      <li>ネットワーク層: ルーターでIPアドレス間を接続し、パケットを受け渡す。 (IP, ARP, IPSec, ICMP, etc.)</li>
      <li>データリンク層: ブリッジやスイッチでMACアドレス間を接続し、フレームを受け渡す。 (PPP, LL2TP, etc.)</li>
      <li>物理層: ハブやリピーターやケーブルなどで端子間を接続し、電気信号を受け渡す。 (UTP, 無線, etc.)</li>
    </ol>
    セッション層以上はソフトウェアの領域で、トランスポート層以下はネットワークの領域。
    L2スイッチ、L3スイッチとあるようにスイッチは「データをあて先に振り分ける」ことができるのでネットワーク層でも使われる。
    ただ、L3スイッチはLAN同士を接続するのに対し、ルーターはLANとWANを接続できる。共通してLANを超えた通信を行うための機器。 (L3スイッチでもWANポートが搭載されたものもあるので気にしなくてもいいかもね)
    IPSecにはトランスポートモードとトンネルモードがある。トランスポートモードではホスト間の全経路上で暗号化される。トンネルモードでは装置間でのみ暗号化。S/MIMEは端末間の暗号化なのでメールサーバー内部でも暗号化されている。


    <h2>公開鍵基盤PKIについて</h2>
    暗号には二種類ある。対称鍵暗号と非対称鍵暗号。前者は共通鍵暗号とも呼ばれ、暗号と復号に同じ鍵を用いる。AES暗号などが有名。
    後者は暗号と復号に異なる鍵を用いる。RSA暗号や楕円曲線暗号が有名。
    対称鍵暗号では会話したい相手に鍵を運搬する必要があり、この間に第三者に鍵を盗み見られる危険性があるという鍵運搬問題が発生する。
    非対称鍵暗号ではこの点を克服した。
    具体的には、送信先の公開鍵でデータを暗号化して送り、受信者は自身の秘密鍵で復号化する。
    また、署名というデータの送り主がその人であること、データが改ざんされていないことを証明することも可能になる。
    送り主はデータを自身の秘密鍵で署名、署名データと元データを一緒に相手に送る。相手は署名データを送信元の公開鍵で検証、元データと一致すれば改ざんの有無と送信元の一致を確認できる。
    一方、あるいたずらが可能となる。送信先の公開鍵を別のものと入れ替えるというもの。もしこの入れ替えを食らうと以降の復号が成功しない。
    そこで登場するのが認証局CA。各自が自身の公開鍵を身分情報などと一緒にCAに登録してもらい、証明書を作ってもらう。
    この証明書にはCAの秘密鍵で署名された公開鍵が含まれている。
    誰かの公開鍵を貰ったが、これが正しいか確かめるためにCAに問い合わせ証明書を貰い検証を行うことで正しい公開鍵かを知ることができる。
    公開鍵と秘密鍵のペアは漏洩したタイミングなどで更新されるので、CAに登録した情報もいつの間にか更新されて、昔の公開鍵でやり取りを開始してしまうことが考えられる。
    OCSP (Online Certificate Status Protocol)では自分が持っている証明書の失効情報を問い合わせることができる。証明書に含まれるシリアル番号を送信し、今も有効かどうか知ることが出来る。
    昔はValidation Authority VAの公開していたCRLという、有効期限内に失効した証明書のシリアル番号のリストをわざわざ見に行って検証していたらしい。
    CAの秘密鍵は様々な仕組みでとても厳重に保管されている。
    <a href="https://euske.github.io/slides/certs202301/index.html">CAのchainingについての説明</a>

    <h2>CVSSとCVEとCCEとCWEとCPEについて。脆弱性対策関連情報の用語。</h2>
    <ol>
      <li>CVE: Common Vulnerability Enumeration. 共通脆弱性識別子。JVN (Japan Vulnerability Notes)などの脆弱性情報を取り扱うサイトで公開されている、製品に含まれる脆弱性を識別するための識別子。異なる組織間で共通の脆弱性情報を参照できるので嬉しい。米国のMITRE社が管理。JSのLog4jとか、そういう単位で。</li>
      <li>CVSS: Common Vulnerability Scoring System. 共通脆弱性評価システム。基本評価基準、現状評価基準、環境評価基準の三つの基準ごとに0.0から10.0でスコアをつけて脆弱性を評価する。米国のNIACのプロジェクトでFIRSTが管理してる。</li>
      <li>CCE: Common Configuration Enumeration. 共通設定項目一覧。必要なセキュリティ設定項目を識別するための識別子。米国のMITRE社が管理。パスワードの最低文字数とか、有効期間とか、見ておけよ、って項目がいろいろ記載されてる。</li>
      <li>CWE: Common Weakness Enumeration. 共通脆弱性タイプ一覧。ソフトウェアやハードウェアの設計・脆弱性を体系的に分類・識別する辞書データベース。米国のMITRE社が管理。上位IDほど抽象的。領域外書き込みとか、そういう単位で。</li>
      <li>CPE: Common Platform Enumeration. 共通プラットフォーム一覧。情報システムを構成する、ハードウェア、ソフトウェアなどを識別する。米国のMITRE社が管理。</li>
    </ol>

    <h2>OSI参照モデルの層間を移動する際にデータにくっつくヘッダー情報について</h2>
    トランスポート層であるデータ、IPパケットを上からもらった。何かしようとしてるらしい。この時に見るのがIPパケットのヘッダー情報。一個下の層でどんなプロトコルをするべきなのか指示が書いてある。
    ICMPである1がプロトコルフィールドに書いてあったらそれが出来る方面のゲートウェイに渡す。
    TCPなら6。

    <h2>攻撃いろいろ</h2>
    <ol>
      <li>サイドチャネル攻撃</li>
      <ol>
        <li>故障利用攻撃: Fault injection attack. デバイスに限定的な故障を故意に与え、デバイスの計算誤りから秘密情報を解析する。</li>
        <li>タイミング攻撃: 暗号化や復号に要する時間の差異を統計的に解析して暗号かぎを推定する。</li>
        <li>電力解析攻撃: 消費電力の変化に着目して鍵や処理内容の解析を試みる。</li>
        <li>電磁場解析攻撃: テンペスト攻撃。機器が発する電磁波を推定することによって秘密情報の取得を試みる。</li>
      </ol>
      <li>線形解読法: 暗号化関数の線形近似式を発見することで暗号鍵を推定</li>
      <li>差分解読法: 入力値の差分が出力値に及ぼす影響を分析して暗号鍵を推定</li>
      <li>総当たり攻撃: ブルートフォース攻撃。暗号鍵の候補全てを確かめる。</li>
      <li>中間者攻撃: Man in the middle. 通信を行う二者間に第三者が割り込み、通信を盗聴したり、通信に介入したりする。トランザクション署名で対策。</li>
      <li>Smurf攻撃: ICMP echo request (ping)の送信元を攻撃対象として沢山の端末に送り付ける。</li>
      <li>SYN Flood: TCP接続要求であるSYNパケットを大量に送り付ける。</li>
      <li>UDP Flood: サイズの大きいUDPパケットを大量に送り付ける。</li>
      <li>メールボム攻撃: サイズの大きいメールを送り付ける。</li>
      <li>マルチベクトル型DDoS: 複数のDDoS攻撃の手法を組み合わせる。フラッド系、スロー系など。フラッド系には反射型DoS, DRDoSがある。</li>
      <li>ゼロデイ: 攻撃者のみの知る脆弱性を悪用する</li>
      <li>SEOポイズニング: Serch Engine Optimization Poisoning. 検索エンジンの検索で上位に表示されるページに悪意のあるものを紛れ込ませる。</li>
      <li>Pass the hash攻撃: ハッシュ化された認証情報を窃取し、それをそのまま提示して不正に認証を迂回する。</li>
      <li>XSS: 動的にwebページを制しえするアプリケーションの不備を利用して悪意のあるスクリプトを混入させ巣。引用符やHTMLタグの入力を無効化する処理で対策。</li>
      <li></li>
    </ol>

    <h2>CRYPTREC暗号リスト</h2>
    電子政府推奨暗号リスト、推奨候補暗号リスト、運用監視暗号リスト
    おすすめ、次のおすすめ、仕方なしの連中

    <h2>シングルサインオンの実装方式</h2>
    <ul>
      <li>クッキーを使用: 最初のログイン時にサーバーから認証識別情報をクッキーとしてもらう。httpレスポンスで貰う。同一ドメイン内ページに限られる。</li>
      <li>リバースプロキシを使用: リバースプロキシが各サービスへ代理アクセスする。IDパスのほか証明書でも任所出来る。他のドメインにあるサービスに回すのは難しい。</li>
      <li>SAMLを使用: 他のドメイン間との間認証情報を共有。Identity ProviderがServise Providerの認証要求によって利用者認証を行う。成功後に発行されるアサーションをSPが検証し、問題なければ利用者がSPにアクセス。</li>
      <li>Kerberosを使用: 認証サーバーはKerberosプロトコルを使用して利用者認証を行い、クライアントは認証成功後に発行されるチケットを使用してSPにアクセスする。</li>
    </ul>

    <h2>IPアドレスのクラス</h2>
    <ul>
      <li>クラスA: 先頭0-127. ネットワーク部8bit. 大規模ネットワークでプライベートアドレスとして使用される。10.0.0.0から10.255.255.255まで。</li>
      <li>クラスB: 先頭128-191. ネットワーク部16bit. 中規模ネットワークでプライベートアドレスとして使用される。172.16.0.0から172.31.255.255まで。</li>
      <li>クラスC: 先頭192-223. ネットワーク部24bit. 小規模ネットワークでプライベートアドレスとして使用される。192.168.0.0から192.168.255.255まで。</li>
      <li>クラスD: 先頭224-239. 特定グループに所属する全てのホストに同時送信を行うマルチキャストで使用されるアドレス。先頭4bitは1110で後ろにグループ番号がつく。ホストに割り当てることは出来ない。</li>
      <li>クラスE: IETFでの実験用アドレスとして予約されている。</li>
    </ul>

    <h2>プロトコルいろいろ</h2>
    <ol>
      <li>Spaning Tree Protocol. Rapid TSP RTSP.: フレームの転送経路の冗長化のためにループを構成する必要があるが、ブロードキャストフレームストームが発生しうるので論理的な木構造として扱う事でこれを阻止する。ブリッジ間で情報を共有し、木構造の再構成など行う。</li>
      <li>IP25B: Inbound Port 25 Blocking. ISPが実施する迷惑メール対策。他社ISPの動的IPアドレスからSMTP25番ポートへ入線があったときこれを拒否する。</li>
      <li>OP25B: Outbound Port 25 Blocking. 自社ISPの動的IPアドレスから他社ISPのSMTP25番ポートへ送信があったときこれを拒否する。</li>
      <li>ICMP: Internet Control Message Protocol. pingとか。</li>
      <li>PPP: Point to point protocol. 1対1の通信。</li>
      <li>EAP: extensible Authentication Protocol. PPPの認証機能を拡張した。L2で使われる認証の仕組み。TLS, MD5, S/keyなどいろいろな認証方式をサポート。</li>
      <li>Diffie-Hellman鍵交換: <a href="https://qiita.com/okajima/items/036d7e751234f88fbe9a">外部サイト</a>x^y=z mod p. pが大きい素数の時、x, zからyを求めるのが困難であることを利用する。x, pを共有。aliceとbobは秘密のyを決める。それぞれでx^y mod pを計算して交換、その値に自身の秘密のyで^y mod pする。この時の値は両者で共通なので共通鍵として使える。</li>
      <li>PGP: Pretty Good Privacy. メールアドレスごとに証明書を用意する。両者のメールソフトがこれに対応していることが必要。web of trustで認証局を必要としない。</li>
      <li>S/MIME: Secure/Multipurpose Internet Mail Extensions. メールアドレスごとに証明書を用意する。両者で対応必須。</li>
      <li>SMTP over TLS: Simple Mail Transfar Protocol over Transport Layer Security. サーバーごとに証明書を用意する。送信者から送信者のメールサーバーまでの経路が暗号化される。</li>
      <li>ダイナミックパケットフィルタリング: Firewallの方式の一つであり、過去に通過したリクエストパケットに対応する戻りパケットを通過させる。一時的ルールを追加したり消したり。データ部分は見ない。</li>
      <li>RADIUS: Remote Authentication Dial In User Servise. 認証、利用ログを単一サーバーに一元化する。暗号化はしない。</li>
      <li>DKIM: DomainKeys Identified Mail. 送信メールのヘッダーと本文から署名を作成、受信者は送信側ドメインのDNSで公開鍵を取得しこれを検証、正当なサーバーからのメールであることを確認する。</li>
      <li>SMTP-Auth: 送信側メールサーバーで送信者が認証された場合に送信を許可する</li>
      <li>SPF: Sender Policy Framework. 電子メール送信元のIPアドレスを検証する仕組み。</li>
      <li>VRRP: Virtual Router redundancy Protocol. 複数のルーターに共通して使える仮想IP, 仮想MACを用意し障害発生時に2つのアドレスをフェールオーバーで待機系に移す。ルーターの冗長化。</li>
      <li>RARP: Reverse Address Resolution Protocol. ARPでIPからMACを取得することの逆。MACからIPをとる。</li>
      <li>SMTP over SSL: SMTP over TLSと似た感じ</li>
      <li>APOP: Authenticated POP. 利用者が電子メールを受信する際の認証情報を秘匿できるようにパスワードのハッシュ値で利用者認証。</li>
      <li>POP before SMTP: SMTPサーバーへ送信する前に受信し、その際にパスワード認証を行う。このクライアントのIPアドレスが一時的に送信許可される。</li>
    </ol>
  </body>
</html>